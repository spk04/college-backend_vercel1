<!DOCTYPE html>
<html>
<head>
  <title>College Student Portal</title>
</head>
<body>

<h2>Student Registration</h2>
<input id="name" name="name" placeholder="Name">
<input id="regUser" name="username" placeholder="Username">
<input id="regPass" name="password" type="password" placeholder="Password">
<input id="branch" name="branch" placeholder="Branch">
<input id="year" name="year" type="number" placeholder="Year">
<input id="cgpa" name="cgpa" type="number" step="0.01" placeholder="CGPA">
<button onclick="register()">Register</button>


<h2>Student Login</h2>
<input id="logUser" placeholder="Username">
<input id="logPass" placeholder="Password" type="password">
<button onclick="login()">Login</button>

<p id="result"></p>

<script>
const baseUrl = "https://college-backend-api-g4c2hmbkaub0huh8.centralindia-01.azurewebsites.net";

async function register() {
  const res = await fetch(baseUrl + "/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      name: document.getElementById("name").value.trim(),
      username: document.getElementById("regUser").value.trim(),
      password: document.getElementById("regPass").value,
      branch: document.getElementById("branch").value.trim(),
      year: Number(document.getElementById("year").value),
      cgpa: Number(document.getElementById("cgpa").value)
    })
  });

  const text = await res.text();
  result.innerText = text;
}


async function login() {
  const res = await fetch(baseUrl + "/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      username: document.getElementById("logUser").value.trim(),
      password: document.getElementById("logPass").value
    })
  });

  const text = await res.text();
  result.innerText = text;

  if (res.status === 200) {
    fetchStudentDetails(document.getElementById("logUser").value.trim());
  }
}


async function fetchStudentDetails(username) {
  const res = await fetch(baseUrl + "/students/" + username);
  const data = await res.json();

  result.innerHTML = `
    <h3>Student Profile</h3>
    <p><b>Name:</b> ${data.name}</p>
    <p><b>Username:</b> ${data.username}</p>
    <p><b>Branch:</b> ${data.branch}</p>
    <p><b>Year:</b> ${data.year}</p>
    <p><b>CGPA:</b> ${data.cgpa}</p>
  `;
}

</script>

</body>
</html>
